<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>model</title>
<link rel="stylesheet" href="/css/nojs/ui.css">
<script src="/js/lib/nojs/noJS.js" id="nojs"></script>
<script>
noJS.config({
    base : '/src/',
    alias : {
        '$' : 'lib/jquery/jquery',
        'ui' : 'lib/nojs/ui'
    }
})
</script>
</head>
<body>
<style>
    .nj_module{margin:20px;border:1px solid #e4e4e4;padding:20px;}
</style>
<div nj-module="arrayEach" class="nj_module">
    <input type="text" nj-item="names">{{names}}-{{list.length}}
    <textarea cols="" rows="4" style="vertical-align:top">{{listStr()}}</textarea>
    <ul nj-each="list">
        <li>{{$key}}  {{$parent.names+name}} 
            <input type="text" nj-item="name" />
            <a href="" 
                style="color:{{$parent.list.length<2?'#ccc':''}}"
                nj-click="$parent.list.length>1 && $parent.list.splice($key,1)"

                >remove</a>
        </li>
    </ul> 
    <button class="nj_btn" nj-click="add()">add</button>

    <ul nj-each="list1">
        <li>name: {{$key}} <a href="" class="gray9" nj-click="$parent.remove($key)">remove</a>
            <div nj-each="$data" style="margin-left:20px">key:{{$key}}-{{$data}} | </div>
        </li>
    </ul>
    <a href="" nj-click="addList1()">add list1</a>
</div>

<div nj-module="myModule" class="nj_module">
    <div>
        <textarea data-name="{{name}}">{{name}}+abc</textarea>
    </div>
    <input type="text" nj-item="name" value="" />
    <div data-class="{{name}}">name:{{arr.x.b+1}} - {{name1}}</div>

    <input type="radio" name="njRadio" nj-item="checked" checked="checked" value="1">
    <input type="radio" name="njRadio" nj-item="checked" value="2">{{checked}}

    <select name="" disabled="{{checked>1}}"  nj-each="select|repeat:0|selected:selectedOptions">
        <optgroup label="{{label}}">
            <option value="{{value}}" nj-each="options|repeat:true">{{name}}</option>
        </optgroup>
    </select>
</div>

<div nj-module="clickToggle" class="nj_module">
    <button type="button" nj-click="toggle =! toggle">open</button>
    <div class="{{toggle?'':'d_hide'}}">isopen:{{toggle}} details……</div>
</div>

<script>
noJS.use('$,ui,lib/nojs/model', function($,ui,nj){
    nj.module('arrayEach', function(scope){
        this.names = 'abc';        
        this.list = [
            {name:1}, {name:2}
        ]
        this.listStr = function(){
            var a = JSON.stringify(this.list);
            return a;
        }
        this.list1 = {
            '11' : [1,2,3],
            '12' : [4,5]
        }
        this.add = function(){
            this.$set('list.push', {name:this.list.length+1});
        }   
        this.remove = function($key){
            delete this.list1[$key];
            scope.apply('list1');
        }
        var key = 12;
        this.addList1 = function(){
            this.list1[++key] = [key, 33];
            scope.apply('list1');
        }
    })
    return;
    nj.module('myModule', function(scope){
        this.name = 'myname';
        this.arr = {
            x:{a:1, b:2}
        };
        this.select = [
            {label:'group1', options:[
                {name:'s1',value:1},
                {name:'s2',value:2}
            ]},
            {label:'group2', options:[
                {name:'s3',value:3},
                {name:'s4',value:4}
            ]}
        ]
        // this.select = {
        //     '01' : {name:'s1',value:11},
        //     '02' : {name:'s2',value:22},
        //     '03' : {name:'s3',value:33}
        // }
        this.selectedOptions = [1]

        var self = this;
        setTimeout(function(){
            self.$set('name1','myname1');
            self.$set('arr.x.b', 3);

            // self.$set('selectedOptions.push', 3);
            //scope.apply('select')
        },2000)
    });
    //return;
    

    nj.module('clickToggle', function(){
        this.slide = function(a,b){
            console.log(a,b)
        };

    })
    
    
})
</script>

</body>
</html>